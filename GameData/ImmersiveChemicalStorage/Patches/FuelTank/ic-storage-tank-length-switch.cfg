@PART[ic-storage-tank-250-*,ic-storage-tank-375-*]
{
	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = lengthSwitch
		parentID = fuelSwitch
		switcherDescription = Length

		SUBTYPE
		{
			name = 1
			title = 1 (1.875m)
			primaryColor = White
			secondaryColor = White
		}
		SUBTYPE
		{
			name = 1.5
			title = 1.5 (2.8125m)
			primaryColor = White
			secondaryColor = White
			addedCost = 0.5
			addedMass = 0.5
			volumeAddedToParent = 0.5
			transform = cylinderHalf
			transform = lidHorizontal
			transform = baseHorizontalTop
			transform = baseHorizontalBottom
			NODE
			{
				name = top
				position = 0.0, 1.40625, 0.0
			}
			NODE
			{
				name = bottom
				position = 0.0, -1.40625, 0.0
			}
			TRANSFORM
			{
				name = tankTop
				positionOffset = 0.0, 0.46875, 0.0
			}
			TRANSFORM
			{
				name = cylinderHalf
				positionOffset = 0.0, 0.0, 0.0
			}
			TRANSFORM
			{
				name = tankBottom
				positionOffset = 0.0, -0.46875, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalTop
				positionOffset = 0.0, 0.46875, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalBottom
				positionOffset = 0.0, -0.46875, 0.0
			}
		}
		SUBTYPE
		{
			name = 2
			title = 2 (3.75m)
			primaryColor = White
			secondaryColor = White
			addedCost = 1.0
			addedMass = 1.0
			volumeAddedToParent = 1.0
			transform = cylinder1
			transform = lidHorizontal
			transform = baseHorizontalTop
			transform = baseHorizontalBottom
			NODE
			{
				name = top
				position = 0.0, 1.875, 0.0
			}
			NODE
			{
				name = bottom
				position = 0.0, -1.875, 0.0
			}
			TRANSFORM
			{
				name = tankTop
				positionOffset = 0.0, 0.9375, 0.0
			}
			TRANSFORM
			{
				name = tankBottom
				positionOffset = 0.0, -0.9375, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalTop
				positionOffset = 0.0, 0.9375, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalBottom
				positionOffset = 0.0, -0.9375, 0.0
			}
		}
		SUBTYPE
		{
			name = 2.5
			title = 2.5 (4.6875m)
			primaryColor = White
			secondaryColor = White
			addedCost = 1.5
			addedMass = 1.5
			volumeAddedToParent = 1.5
			transform = cylinderHalf
			transform = cylinder1
			transform = lidHorizontal
			transform = baseHorizontalTop
			transform = baseHorizontalBottom
			NODE
			{
				name = top
				position = 0.0, 2.34375, 0.0
			}
			NODE
			{
				name = bottom
				position = 0.0, -2.34375, 0.0
			}
			TRANSFORM
			{
				name = tankTop
				positionOffset = 0.0, 1.40625, 0.0
			}
			TRANSFORM
			{
				name = cylinder1
				positionOffset = 0.0, 0.46875, 0.0
			}
			TRANSFORM
			{
				name = cylinderHalf
				positionOffset = 0.0, -0.9375, 0.0
			}
			TRANSFORM
			{
				name = tankBottom
				positionOffset = 0.0, -1.40625, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalTop
				positionOffset = 0.0, 0.9375, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalBottom
				positionOffset = 0.0, -0.9375, 0.0
			}
		}
		SUBTYPE
		{
			name = 3
			title = 3 (5.625m)
			primaryColor = White
			secondaryColor = White
			addedCost = 2.0
			addedMass = 2.0
			volumeAddedToParent = 2.0
			transform = cylinder1
			transform = cylinder2
			transform = lidHorizontal
			transform = baseHorizontalTop
			transform = baseHorizontalBottom
			NODE
			{
				name = top
				position = 0.0, 2.8125, 0.0
			}
			NODE
			{
				name = bottom
				position = 0.0, -2.8125, 0.0
			}
			TRANSFORM
			{
				name = tankTop
				positionOffset = 0.0, 1.875, 0.0
			}
			TRANSFORM
			{
				name = cylinder1
				positionOffset = 0.0, 0.9375, 0.0
			}
			TRANSFORM
			{
				name = cylinder2
				positionOffset = 0.0, -0.9375, 0.0
			}
			TRANSFORM
			{
				name = tankBottom
				positionOffset = 0.0, -1.875, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalTop
				positionOffset = 0.0, 1.40625, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalBottom
				positionOffset = 0.0, -1.40625, 0.0
			}
		}
		SUBTYPE
		{
			name = 3.5
			title = 3.5 (6.5625m)
			primaryColor = White
			secondaryColor = White
			addedCost = 2.5
			addedMass = 2.5
			volumeAddedToParent = 2.5
			transform = cylinder1
			transform = cylinder2
			transform = cylinderHalf
			transform = lidHorizontal
			transform = baseHorizontalTop
			transform = baseHorizontalBottom
			NODE
			{
				name = top
				position = 0.0, 3.28125, 0.0
			}
			NODE
			{
				name = bottom
				position = 0.0, -3.28125, 0.0
			}
			TRANSFORM
			{
				name = tankTop
				positionOffset = 0.0, 2.34375, 0.0
			}
			TRANSFORM
			{
				name = cylinder1
				positionOffset = 0.0, 1.40625, 0.0
			}
			TRANSFORM
			{
				name = cylinder2
				positionOffset = 0.0, -0.46875, 0.0
			}
			TRANSFORM
			{
				name = cylinderHalf
				positionOffset = 0.0, -1.875, 0.0
			}
			TRANSFORM
			{
				name = tankBottom
				positionOffset = 0.0, -2.34375, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalTop
				positionOffset = 0.0, 1.40625, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalBottom
				positionOffset = 0.0, -1.40625, 0.0
			}
		}
		SUBTYPE
		{
			name = 4
			title = 4 (7.5m)
			primaryColor = White
			secondaryColor = White
			addedCost = 3.0
			addedMass = 3.0
			volumeAddedToParent = 3.0
			transform = cylinder1
			transform = cylinder2
			transform = cylinder3
			transform = lidHorizontal
			transform = baseHorizontalTop
			transform = baseHorizontalBottom
			NODE
			{
				name = top
				position = 0.0, 3.75, 0.0
			}
			NODE
			{
				name = bottom
				position = 0.0, -3.75, 0.0
			}
			TRANSFORM
			{
				name = tankTop
				positionOffset = 0.0, 2.8125, 0.0
			}
			TRANSFORM
			{
				name = cylinder1
				positionOffset = 0.0, 1.875, 0.0
			}
			TRANSFORM
			{
				name = cylinder2
				positionOffset = 0.0, 0.0, 0.0
			}
			TRANSFORM
			{
				name = cylinder3
				positionOffset = 0.0, -1.875, 0.0
			}
			TRANSFORM
			{
				name = tankBottom
				positionOffset = 0.0, -2.8125, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalTop
				positionOffset = 0.0, 1.875, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalBottom
				positionOffset = 0.0, -1.875, 0.0
			}
		}
		SUBTYPE
		{
			name = 4.5
			title = 4.5 (8.4375m)
			primaryColor = White
			secondaryColor = White
			addedCost = 3.5
			addedMass = 3.5
			volumeAddedToParent = 3.5
			transform = cylinder1
			transform = cylinder2
			transform = cylinder3
			transform = cylinderHalf
			transform = lidHorizontal
			transform = baseHorizontalTop
			transform = baseHorizontalBottom
			NODE
			{
				name = top
				position = 0.0, 4.21875, 0.0
			}
			NODE
			{
				name = bottom
				position = 0.0, -4.21875, 0.0
			}
			TRANSFORM
			{
				name = tankTop
				positionOffset = 0.0, 3.28125, 0.0
			}
			TRANSFORM
			{
				name = cylinder1
				positionOffset = 0.0, 2.34375, 0.0
			}
			TRANSFORM
			{
				name = cylinder2
				positionOffset = 0.0, 0.46875, 0.0
			}
			TRANSFORM
			{
				name = cylinder3
				positionOffset = 0.0, -1.40625, 0.0
			}
			TRANSFORM
			{
				name = cylinderHalf
				positionOffset = 0.0, -2.8125, 0.0
			}
			TRANSFORM
			{
				name = tankBottom
				positionOffset = 0.0, -3.28125, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalTop
				positionOffset = 0.0, 1.875, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalBottom
				positionOffset = 0.0, -1.875, 0.0
			}
		}
		SUBTYPE
		{
			name = 5
			title = 5 (9.375m)
			primaryColor = White
			secondaryColor = White
			addedCost = 4.0
			addedMass = 4.0
			volumeAddedToParent = 4.0
			transform = cylinder1
			transform = cylinder2
			transform = cylinder3
			transform = cylinder4
			transform = lidHorizontal
			transform = baseHorizontalTop
			transform = baseHorizontalBottom
			NODE
			{
				name = top
				position = 0.0, 4.6875, 0.0
			}
			NODE
			{
				name = bottom
				position = 0.0, -4.6875, 0.0
			}
			TRANSFORM
			{
				name = tankTop
				positionOffset = 0.0, 3.75, 0.0
			}
			TRANSFORM
			{
				name = cylinder1
				positionOffset = 0.0, 2.8125, 0.0
			}
			TRANSFORM
			{
				name = cylinder2
				positionOffset = 0.0, 0.9375, 0.0
			}
			TRANSFORM
			{
				name = cylinder3
				positionOffset = 0.0, -0.9375, 0.0
			}
			TRANSFORM
			{
				name = cylinder4
				positionOffset = 0.0, -2.8125, 0.0
			}
			TRANSFORM
			{
				name = tankBottom
				positionOffset = 0.0, -3.75, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalTop
				positionOffset = 0.0, 2.34375, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalBottom
				positionOffset = 0.0, -2.34375, 0.0
			}
		}
		SUBTYPE
		{
			name = 5.5
			title = 5.5 (10.3125m)
			primaryColor = White
			secondaryColor = White
			addedCost = 4.5
			addedMass = 4.5
			volumeAddedToParent = 4.5
			transform = cylinder1
			transform = cylinder2
			transform = cylinder3
			transform = cylinder4
			transform = cylinderHalf
			transform = lidHorizontal
			transform = baseHorizontalTop
			transform = baseHorizontalBottom
			NODE
			{
				name = top
				position = 0.0, 5.15625, 0.0
			}
			NODE
			{
				name = bottom
				position = 0.0, -5.15625, 0.0
			}
			TRANSFORM
			{
				name = tankTop
				positionOffset = 0.0, 4.21875, 0.0
			}
			TRANSFORM
			{
				name = cylinder1
				positionOffset = 0.0, 3.28125, 0.0
			}
			TRANSFORM
			{
				name = cylinder2
				positionOffset = 0.0, 1.40625, 0.0
			}
			TRANSFORM
			{
				name = cylinder3
				positionOffset = 0.0, -0.46875, 0.0
			}
			TRANSFORM
			{
				name = cylinder4
				positionOffset = 0.0, -2.34375, 0.0
			}
			TRANSFORM
			{
				name = cylinderHalf
				positionOffset = 0.0, -3.75, 0.0
			}
			TRANSFORM
			{
				name = tankBottom
				positionOffset = 0.0, -4.21875, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalTop
				positionOffset = 0.0, 2.34375, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalBottom
				positionOffset = 0.0, -2.34375, 0.0
			}
		}
		SUBTYPE
		{
			name = 6
			title = 6 (11.25m)
			primaryColor = White
			secondaryColor = White
			addedCost = 5.0
			addedMass = 5.0
			volumeAddedToParent = 5.0
			transform = cylinder1
			transform = cylinder2
			transform = cylinder3
			transform = cylinder4
			transform = cylinder5
			transform = lidHorizontal
			transform = baseHorizontalTop
			transform = baseHorizontalBottom
			NODE
			{
				name = top
				position = 0.0, 5.625, 0.0
			}
			NODE
			{
				name = bottom
				position = 0.0, -5.625, 0.0
			}
			TRANSFORM
			{
				name = tankTop
				positionOffset = 0.0, 4.6875, 0.0
			}
			TRANSFORM
			{
				name = cylinder1
				positionOffset = 0.0, 3.75, 0.0
			}
			TRANSFORM
			{
				name = cylinder2
				positionOffset = 0.0, 1.875, 0.0
			}
			TRANSFORM
			{
				name = cylinder4
				positionOffset = 0.0, -1.875, 0.0
			}
			TRANSFORM
			{
				name = cylinder5
				positionOffset = 0.0, -3.75, 0.0
			}
			TRANSFORM
			{
				name = tankBottom
				positionOffset = 0.0, -4.6875, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalTop
				positionOffset = 0.0, 2.8125, 0.0
			}
			TRANSFORM
			{
				name = baseHorizontalBottom
				positionOffset = 0.0, -2.8125, 0.0
			}
		}
	}
}

// Size-specific model changes
@PART[ic-storage-tank-250-*]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[lengthSwitch]]
	{
		@SUBTYPE[1]
		{
			TRANSFORM
			{
				name = domeBottom
				rotationOffset = 0.0, 60.0, 0.0
			}
		}
		@SUBTYPE[2]
		{
			TRANSFORM
			{
				name = domeBottom
				rotationOffset = 0.0, 60.0, 0.0
			}
		}
		@SUBTYPE[3]
		{
			TRANSFORM
			{
				name = domeBottom
				rotationOffset = 0.0, 60.0, 0.0
			}
		}
		@SUBTYPE[4]
		{
			TRANSFORM
			{
				name = domeBottom
				rotationOffset = 0.0, 60.0, 0.0
			}
		}
		@SUBTYPE[5]
		{
			TRANSFORM
			{
				name = domeBottom
				rotationOffset = 0.0, 60.0, 0.0
			}
		}
		@SUBTYPE[6]
		{
			TRANSFORM
			{
				name = domeBottom
				rotationOffset = 0.0, 60.0, 0.0
			}
		}
	}
}
@PART[ic-storage-tank-375-*]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[lengthSwitch]]
	{
		@SUBTYPE[1]
		{
			TRANSFORM
			{
				name = domeBottom
				rotationOffset = 0.0, 45.0, 0.0
			}
		}
		@SUBTYPE[2]
		{
			TRANSFORM
			{
				name = domeBottom
				rotationOffset = 0.0, 45.0, 0.0
			}
		}
		@SUBTYPE[2.5]
		{
			@TRANSFORM[cylinderHalf]
			{
				%rotationOffset = 0.0, 90.0, 0.0
			}
		}
		@SUBTYPE[3]
		{
			TRANSFORM
			{
				name = domeBottom
				rotationOffset = 0.0, 45.0, 0.0
			}
		}
		@SUBTYPE[4]
		{
			transform = baseHorizontalCentre
			TRANSFORM
			{
				name = domeBottom
				rotationOffset = 0.0, 45.0, 0.0
			}
		}
		@SUBTYPE[4.5]
		{
			transform = baseHorizontalCentre
			@TRANSFORM[cylinderHalf]
			{
				%rotationOffset = 0.0, 90.0, 0.0
			}
		}
		@SUBTYPE[5]
		{
			transform = baseHorizontalCentre
			TRANSFORM
			{
				name = domeBottom
				rotationOffset = 0.0, 45.0, 0.0
			}
		}
		@SUBTYPE[5.5]
		{
			transform = baseHorizontalCentre
		}
		@SUBTYPE[6]
		{
			transform = baseHorizontalCentre
			TRANSFORM
			{
				name = domeBottom
				rotationOffset = 0.0, 45.0, 0.0
			}
		}
		@SUBTYPE:HAS[@TRANSFORM[cylinder2]]
		{
			@TRANSFORM[cylinder2]
			{
				%rotationOffset = 0.0, 90.0, 0.0
			}
		}
		@SUBTYPE:HAS[@TRANSFORM[cylinder2]]
		{
			@TRANSFORM[cylinder4]
			{
				%rotationOffset = 0.0, 90.0, 0.0
			}
		}
	}
}

// Size-specific cost, mass and volume parameters
@PART[ic-storage-tank-250-*]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[lengthSwitch]]
	{
		@SUBTYPE,*
		{
			@addedCost *= 1600
			@addedMass *= 1.0
			@volumeAddedToParent *= 1600
		}
    }
}
@PART[ic-storage-tank-375-*]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[lengthSwitch]]
	{
		@SUBTYPE,*
		{
			@addedCost *= 3600
			@addedMass *= 2.25
			@volumeAddedToParent *= 3600
		}
    }
}

// Increase cost of cryo variants
@PART[ic-storage-tank-*-cryo-light]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[lengthSwitch]]
	{
		@SUBTYPE,*
		{
			@addedCost *= 1.5
		}
    }
}
@PART[ic-storage-tank-*-cryo-heavy]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[lengthSwitch]]
	{
		@SUBTYPE,*
		{
			@addedCost *= 2
		}
    }
}

// Remove mass from basic and light cryo tanks whose mass is entirely determined by the B9_TANK_TYPE
@PART[ic-storage-tank-*-basic,ic-storage-tank-*-cryo-light]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[lengthSwitch]]
	{
		@SUBTYPE,*
		{
			@addedMass *= 0
		}
    }
}